<!DOCTYPE html>
<html>
<head>
	<title>Portfólio Dinâmico</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<meta charset="UTF-8">
	<meta http-equiv="cache-control" content="no-cache"> <!-- tells browser not to cache -->
	<meta http-equiv="expires" content="0"> <!-- says that the cache expires 'now' -->
	<meta http-equiv="pragma" content="no-cache"> <!-- says not to use cached stuff, if there is any -->

	<style>
		main{
		min-height: 1000px;	
		}
		.portfolioContent{
		position: relative;}
		.port{
		height: 200px;
		width: 100%;}
		.portfolioTitulo{
		background: rgba(0,0,0,0.7);
		color: #fff;
		text-align: center;
		font-weight: 700;
		font-size: 120%;
		z-index:1;	
		display:none;
		position: absolute;
		top:0;
		left:0;}
		.portfolioImg{
		position:relative;	
		top:0;
		left:0;}
		.alvo{
		height: 0px;
		visibility: hidden;
		transition: 1s;}
		.alvo-active{
		height: 400px;}
		#alvoimg{
		max-height: 390px;}
		.portfolioItem , .close{
		cursor:pointer;}
	</style>
</head>
<body>
<!--Área de Conteúdo -->
<main class="container-fluid">
	<a href="admin/"><span class="btn btn-info">Admin</span></a>
<div class="row justify-content-center"><h1>Portfólio</h1></div>
<div class="alvo row"></div>
<div class="portfolio row justify-content-center"></div>
</main>

<!--bootstrap.js e jquery-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<!--Scripts da página-->
<script type="text/javascript">
//Escreve o json com todos os itens do banco de dados   
   $.ajax({
        url: "server/loadPage.php",
        type: "POST",
        data: "",
        dataType: "html"
        });
//Exibe os itens do arquivo json com um layout próprio	
$.getJSON('server/json/lista.json',function(data){
var output = "";
$.each(data, function(key,val){
  output += "<div class='col-3 portfolioItem mx-0 px-0' id='" + val.id + "'>";
  output += "<div class='portfolioContent'>";
  output += "<div class='port portfolioTitulo'>"+ val.titulo+"</div>";
  output += "<img class='port potfolioImg img-fluid' src='"+val.imgCaminho+"'></div></div>";
});
$('.portfolio').html(output);
});
</script>
<!--Script da seção detalhes-->
<script type="text/javascript">
//Abre seção detalhes ao clique do item
$(document.body).on('click', '.portfolioItem', function(){
var id = $(this).attr('id');
$('.alvo').html("");
$(".alvo").removeClass('alvo-active');
//Encerra requisições anteriores(em caso de cliques rápidos)
if (typeof loadId != 'undefined') {
    loadId.abort();
}
//Executa a escrita do arquivo json
var loadId = $.ajax({
        url: "server/loadById.php",
        type: "POST",
        data: "id=" + id,
        dataType: "html"
        })
//Gif de Carregamen
$(".alvo").html("<div class='container-fluid text-center'><img src='img/loading.gif' class='img-fluid'></div>");
$('.alvo').addClass('alvo-active');
//Espera 0.5 segundos e escreve a seção detalhes
setTimeout(function(){
$.getJSON('server/json/alvo.json',function(data){
var output =
"<div class='col-6'>"+
"<img src='"+data['imgCaminho']+"' class='img-fluid' id='alvoimg'></div>"+
"<div class='col-5'>"+
"<h3>"+data['titulo']+"</h3>"+
"<p>Tecnologias: "+data['tecnologias']+"</p>"+
"<p>Descrição: "+data['descricao']+"</p>"+
"<p>Acesse: <a href='"+data['link']+"' target='_blank'>"+data['link']+"</a></p>"+	
"</div>"+
"<div class='col-1'><span class='close'>X</span</div>";
$('.alvo').html(output);
$('.alvo').css('visibility','visible'); 
});
},500);
});
//Fecha a seção detalhes
$(document.body).on('click', '.close', function(){
$(".alvo").empty();
$(".alvo").removeClass('alvo-active');	
});
</script>
<!--Script para animar miniaturas de portfólio-->
<script type="text/javascript">
$(document).ready(function(){
$(document.body).on('mouseenter', '.portfolioItem' ,function(){
$(this).find(".portfolioTitulo").fadeIn(400);
});
$(document.body).on('mouseleave', '.portfolioItem' ,function(){
$(this).find(".portfolioTitulo").fadeOut(400);
});
});
</script>

   
</body>
</html>
